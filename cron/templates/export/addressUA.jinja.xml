<?xml version="1.0" encoding="utf-8"?><import>
<listings>
    {% for item in feed.iterate_items() %}
    {%- with
        email = 'bank@mesto.ua' if item.bank_id else item.user.email,
        deal_types = {'sale':2, 'rent':1, 'rent_daily':6},
        property_types = {'flat':1, 'room':6, 'house':2, 'plot':5, 'commercial':8, 'garages':4},
        currencies = {'USD':1, 'EUR':2, 'UAH':3},
        province = item.location.get('province'),
        locality = item.location.get('locality') or item.location.get('village') or '',
        area = item.location.get('area', '').replace(' район', ''),
        regions = {'Винницкая область':3, 'Волынская область':4, 'Днепропетровская область':5, 'Донецкая область':6, 'Житомирская область':7, 'Закарпатская область':8, 'Запорожская область':9, 'Ивано-Франковская область':10, 'Киевская область':2, 'Кировоградская область':11, 'Республика Крым':12, 'Луганская область':13, 'Львовская область':14, 'Николаевская область':15, 'Одесская область':16, 'Полтавская область':17, 'Ровенская область':18, 'Сумская область':19, 'Тернопольская область':20, 'Харьковская область':21, 'Херсонская область':22, 'Хмельницкая область':23, 'Черкасская область':24, 'Черниговская область':25, 'Черновицкая область':26, 'Севастополь':27, 'Киев':1},
        districts = {'3Барский':41, '3Бершадский':42, '3Винница':43, '3Винницкий':44, '3г. Могилев-Подольский':45, '3Гайсинский':46, '3Жмеринка':47, '3Жмеринский':48, '3Ильинецкий':49, '3Казатин':50, '3Казатинский':51, '3Калиновский':52, '3Крижопольский':53, '3Ладыжин':54, '3Липовецкий':55, '3Литинский':56, '3Могилев-Подольский':57, '3Муравано-Куриловецкий':58, '3Немировский':59, '3Оратовский':60, '3Пещанский':61, '3Погребищенский':62, '3Тепликский':63, '3Томашпольский':64, '3Тростянецкий':65, '3Тульчинский':66, '3Тывровский':67, '3Хмельник':68, '3Хмельницкий':69, '3Черновицкий':70, '3Чечельницкий':71, '3Шаргородский':72, '3Ямпольский':73, '4Владимир-Волынский':74, '4г. Владимир-Волынский':75, '4Гороховский':76, '4Иваничивский':77, '4Камень-Каширский':78, '4Киверцовский':79, '4Ковель':80, '4Ковельский':81, '4Локачинский':82, '4Луцк':83, '4Луцкий':84, '4Любешевский':85, '4Любомльский':86, '4Маневичский':87, '4Нововолынск':88, '4Ратновский':89, '4Рожищенский':90, '4Старовыжевский':91, '4Турийский':92, '4Шацкий':93, '5Апостоловский':94, '5Васильковский':95, '5Верхнеднепровский':96, '5Вольногорск':97, '5Днепродзержинск':98, '5Днепропетровск':99, '5Днепропетровский р-н':100, '5Желтые Воды':101, '5Кривой Рог':102, '5Криворожский':103, '5Криничанский':104, '5Магдалиновский':105, '5Марганец':106, '5Межевский':107, '5Никополь':108, '5Никопольский':109, '5Новомосковск':110, '5Новомосковский':111, '5Орджоникидзе':112, '5Павловград':113, '5Павлоградский':114, '5Першотравенск':115, '5Петриковский':116, '5Петропавловский':117, '5Покровский':118, '5Пятихатский':119, '5Синельниково':120, '5Синельниковский':121, '5Солонянский':122, '5Софиевский':123, '5Терновка':124, '5Терновский':125, '5Томаковский':126, '5Царичанский':127, '5Широковский':128, '5Юрьевский':129, '6Авдеевка':131, '6Александровский':132, '6Амвросиевский':133, '6Артемовск':134, '6Артемовский':135, '6Великоновоселковский':136, '6Волновахский':137, '6Володарский':138, '6Горловка':139, '6Дебальцево':140, '6Дзержинск':141, '6Димитров':130, '6Добропольский':142, '6Добрполье':143, '6Докучаевск':144, '6Донецк':145, '6Дружковка':146, '6Енакиево':147, '6Ждановка':148, '6Кировское':149, '6Константиновка':150, '6Константиновский':151, '6Краматорск':152, '6Красноармейск':153, '6Красноармейский':154, '6Краснолиманский':155, '6Красный Лиман':156, '6Макеевка':157, '6Мариуполь':159, '6Марьинский':160, '6Новоазовский':161, '6Новогродовка':162, '6Першотравневый':158, '6Селидово':163, '6Славянск':164, '6Славянский':165, '6Снежное':166, '6Старобешевский':167, '6Тельмановский':168, '6Торез':169, '6Угледар':170, '6Харцызск':171, '6Шахтерск':172, '6Шахтерский':173, '6Ясиноватая':174, '6Ясиноватский':175, '7Андрушевский':176, '7Барановский':177, '7Бердичев':178, '7Бердичевский':179, '7Брусиловский':180, '7Володарско-Волынский':181, '7г.Новоград-Волынский':182, '7Дзержинский':183, '7Емильчинский':184, '7Житомир':185, '7Житомирский':186, '7Коростень':187, '7Коростеньский':188, '7Коростышевский':189, '7Лугинский':190, '7Любарский':191, '7Малинский':192, '7Народичский':193, '7Новоград-Волынский':194, '7Овручский':195, '7Олевский':196, '7Попельнянский':197, '7Радомышльский':198, '7Ружинский':199, '7Червоноармейский':200, '7Черняховский':201, '7Чудновский':202, '8Берегово':203, '8Береговский':204, '8Великоберезнянский':205, '8Виноградовский':206, '8Воловецкий':207, '8Иршавский':208, '8Межгорский':209, '8Мукачево':210, '8Мукачевский':211, '8Перечинский':212, '8Раховский':213, '8Свалявский':214, '8Тячевский':215, '8Ужгород':216, '8Ужгородский':217, '8Хуст':218, '8Хустский':219, '8Чоп':220, '9Акимовский':221, '9Бердянск':222, '9Бердянский':223, '9Васильевский':224, '9Великобелозерский':225, '9Веселовский':226, '9Вольнянский':227, '9Гуляйпольский':228, '9Запорожский':229, '9Запорожье':230, '9Каменско-Днепровский':231, '9Куйбышевский':232, '9Мелитополь':233, '9Мелитопольский':234, '9Михайловский':235, '9Новониколаевский':236, '9Ореховский':237, '9Пологский':238, '9Приазовский':239, '9Приморский':240, '9Розовкский':241, '9Токмак':242, '9Токмакский':243, '9Черниговский':244, '9Энергодар':245, '10Богородчанский':246, '10Болехов':247, '10Верховинский':248, '10Галичский':249, '10Городенковский':250, '10Долинский':251, '10Ивано-Франковск':252, '10Калуш':253, '10Калушский':254, '10Коломыйский':255, '10Коломыя':256, '10Косовский':257, '10Надворнянский':258, '10Рогатинский':259, '10Рожнятовский':260, '10Снятинский':261, '10Тисменицкий':262, '10Тлумачский':263, '10Яремча':264, '1Голосеевский':1, '1Дарницкий':2, '1Деснянский':3, '1Днепровский':4, '1Оболонский':5, '1Печерский':6, '1Подольский':7, '1Святошинский':8, '1Соломенский':9, '1Шевченковский':10, '2Барышевский':11, '2Белая Церковь':675, '2Белогородка':708, '2Белоцерковский':12, '2Березань':676, '2Бобрица':709, '2Богуславский':13, '2Борисполь':677, '2Бориспольский':14, '2Бородянка':710, '2Бородянский':15, '2Боярка':711, '2Броварской':16, '2Бровары':678, '2Буча':689, '2Васильков':679, '2Васильковский':18, '2Володарский':19, '2Вышгород':712, '2Вышгородский':20, '2г. Переяслав-Хмельницкий':717, '2Згуровский':21, '2Иванковский':22, '2Ирпень':680, '2Кагарлык':713, '2Кагарлыкский':23, '2Киево-Святошинский':24, '2Козин':714, '2Макаровский':25, '2Мироновский':26, '2Обухов':685, '2Обуховский':27, '2пгт Ворзель':695, '2пгт Гостомель':694, '2Переяслав-Хмельницкий':28, '2Полесский':29, '2Припять':682, '2Ракитнянский':30, '2Ржищев':683, '2Сквирский':31, '2Славутич':687, '2Ставищенский':32, '2Таращанский':33, '2Тетиевский':34, '2Украинка':715, '2Фастов':684, '2Фастовский':36, '2Яготин':716, '2Яготинский':40, '11Александрийский':265, '11Александрия':266, '11Александровский':267, '11Бобринецкий':268, '11Гайворонский':269, '11Голованевский':270, '11Добровеличковский':271, '11Долинский':272, '11Знаменка':273, '11Знаменский':274, '11Кировоград':275, '11Кировоградский':276, '11Компаниевский':277, '11Маловисковский':278, '11Новгородковский':279, '11Новоархангельский':280, '11Новомиргородский':281, '11Новоукраинский':282, '11Ольшанский':283, '11Онуфриевский':284, '11Петровский':285, '11Светловодск':286, '11Светловодский':287, '11Ульяновский':288, '11Устиновский':289, '12Алупка':686, '12Алушта':290, '12Армянск':291, '12Бахчисарайский':292, '12Белогорский':293, '12Джанкой':294, '12Джанкойский':295, '12Евпатория':296, '12Керчь':297, '12Кировский':298, '12Красногвардейский':299, '12Красноперекопск':300, '12Красноперекопский':301, '12Ленинский':302, '12Нижнегорский':303, '12Первомайский':304, '12Раздольненский':305, '12Саки':306, '12Сакский':307, '12Симферополь':308, '12Симферопольский':309, '12Советский':310, '12Судак':311, '12Феодосия':312, '12Черноморский':313, '12Ялта':314, '12Ялтинский':315, '13Алчевск':316, '13Антрацит':317, '13Антрацитовский':318, '13Беловодский':319, '13Белокуракинский':320, '13Брянка':321, '13Кировск':322, '13Краснодон':323, '13Краснодонский':324, '13Красный Луч':325, '13Кременский':326, '13Лисичанск':327, '13Луганск':328, '13Лутугинский':329, '13Марковский':330, '13Меловский':331, '13Новоайдарский':332, '13Новопсковский':333, '13Первомайск':334, '13Перевальский':335, '13Попаснянский':336, '13Ровеньки':337, '13Рубежное':338, '13Сватовский':339, '13Свердловск':340, '13Свердловский':341, '13Северодонецк':342, '13Славяносербский':343, '13Станично-Луганский':344, '13Старобельский':345, '13Стаханов':346, '13Троицкий':347, '14Борислав':348, '14Бродовский':349, '14Буский':350, '14Городокский':351, '14Дрогобыч':352, '14Дрогобычский':353, '14Жидачовский':354, '14Жолковский':355, '14Золочевский':356, '14Каменско-Бугский':357, '14Львов':358, '14Моршин':359, '14Мостисский':360, '14Николаевский':361, '14пгт Славское':688, '14Перемышлянский':362, '14Пустомытовский':363, '14Радеховский':364, '14Самбор':365, '14Самборский':366, '14Сколевский':367, '14Сокальский':368, '14Старосамборский':369, '14Стрый':370, '14Стрыйский':371, '14Трускавец':372, '14Туркивский':373, '14Червоноград':374, '14Яворовский':375, '15Арбузинский':376, '15Баштанский':377, '15Березанский':378, '15Березнеговатский':379, '15Братский':380, '15Веселиновский':381, '15Вознесенск':382, '15Вознесенский':383, '15Врадиевский':384, '15Доманевский':385, '15Еланецкий':386, '15Жовтневый':387, '15Казанковский':388, '15Кривоозерский':389, '15Николаев':390, '15Николаевский':391, '15Новобугский':392, '15Новоодесский':393, '15Очаков':394, '15Очаковский':395, '15Первомайск':396, '15Первомайский':397, '15Снигиревский':398, '15Южноукраинск':399, '16Ананьевский':400, '16Арцизский':401, '16Балтский':402, '16Белгород-Днестровский':403, '16Беляевский':404, '16Березовский':405, '16Болградский':406, '16Великомихайловский':407, '16г.Белгород-Днестровский':408, '16Ивановский':409, '16Измаил':410, '16Измаилский':411, '16Ильичевск':412, '16Килийский':413, '16Кодымский':414, '16Коминтерновский':415, '16Котовск':416, '16Котовский':417, '16Красноокнянский':418, '16Любашевский':419, '16Нерубайское':706, '16Николаевский':420, '16Овидиополь':707, '16Овидиопольский':421, '16Одесса':422, '16Раздольненский':423, '16Ренийский':424, '16Савранский':425, '16Саратский':426, '16Тарутинский':427, '16Татарбунарский':428, '16Теплодар':429, '16Фонтанка':705, '16Фрунзенский':430, '16Ширяевский':431, '16Южное':432, '17Великобагачанский':433, '17Гадячский':434, '17Глобинский':435, '17Гребенковский':436, '17Диканьский':437, '17Зеньковский':438, '17Карловский':439, '17Кобелякский':440, '17Козельщинский':441, '17Комсомольск':442, '17Котелевский':443, '17Кременчуг':696, '17Кременчугский':444, '17Крюковский':445, '17Лохвицкий':446, '17Лубенский':447, '17Лубны':448, '17Машевский':449, '17Миргород':450, '17Миргородский':451, '17Новосанжарский':452, '17Оржицкий':453, '17Пирятинский':454, '17Полтава':455, '17Полтавский':456, '17Решетиловский':457, '17Семеновский':458, '17Хорольский':459, '17Чернухинский':460, '17Чутовский':461, '17Шишакский':462, '18Березновский':463, '18Владимирецкий':464, '18Гощанский':465, '18Демидовский':466, '18Дубенский':468, '18Дубно':467, '18Дубровицкий':469, '18Заречнянский':470, '18Здолбуновский':471, '18Корецкий':472, '18Костопольский':473, '18Кузнецовск':474, '18Млиновский':475, '18Острог':476, '18Острожский':477, '18Радивиловский':478, '18Ракитновский':479, '18Ровенский':480, '18Ровно':481, '18Сарненский':482, '27Балаклавский':671, '27Гагаринский':672, '27Ленинский':673, '27Нахимовский':674, '19Ахтырка':483, '19Ахтырский':484, '19Белопольский':485, '19Бурынский':486, '19Великописаревский':487, '19Глухов':488, '19Глуховский':489, '19Конотоп':490, '19Конотопский':491, '19Краснопольский':492, '19Кролевецкий':493, '19Лебедин':494, '19Лебединский':495, '19Липоводолинский':496, '19Недригайловский':497, '19Путивльский':498, '19Роменский':499, '19Ромны':500, '19Середино-Будский':501, '19Сумской':502, '19Сумы':503, '19Тростянецкий':504, '19Шостка':505, '19Шосткинский':506, '19Ямпольский':507, '20Бережанский':508, '20Борщевский':509, '20Бучачский':510, '20Гусятинский':511, '20Залещицкий':512, '20Збаражский':513, '20Зборовский':514, '20Козовский':515, '20Кременецкий':516, '20Лановецкий':517, '20Монастырисский':518, '20Подволочисский':519, '20Подгаецкий':520, '20Теребовлянский':521, '20Тернополь':522, '20Тернопольский':523, '20Чортковский':524, '20Шумской':525, '21Балаклейский':526, '21Барвенковский':527, '21Близнюковский':528, '21Богодухов':699, '21Богодуховский':529, '21Боровский':530, '21Валковский':531, '21Велико-Бурлукский':532, '21Волчанский':533, '21Двуречнинский':534, '21Дергачевский':535, '21Дергачи':697, '21Зачепиловский':536, '21Змиев':700, '21Змиевский':537, '21Золочевский':538, '21Изюм':539, '21Изюмский':540, '21Кегичевский':541, '21Коломакский':542, '21Красноградский':543, '21Краснокутский':544, '21Купянск':545, '21Купянский':546, '21Лозовая':547, '21Лозовский':548, '21Люботин':549, '21Малиновка':702, '21Мерефа':701, '21Новая Мерефа':698, '21Нововодолажский':550, '21Первомайск':551, '21Первомайский':552, '21Песочин':703, '21Печенеги':704, '21Печенежский':553, '21Сахновщинский':554, '21Харьков':555, '21Харьковский':556, '21Чугуев':557, '21Чугуевский':558, '21Шевченковский':559, '22Белозерский':560, '22Бериславский':561, '22Великоалександровский':562, '22Великолепетихинский':563, '22Верхнерогачикский':565, '22Высокопольский':564, '22Генический':566, '22Голопристанский':567, '22Горностаевский':568, '22Ивановкский':569, '22Каланчакский':570, '22Каховка':571, '22Каховский':572, '22Нижнесерогозский':573, '22Новая Каховка':574, '22Нововоронцовский':575, '22Новотроицкий':576, '22Скадовск':577, '22Скадовский':692, '22Херсон':578, '22Цюрупинский':579, '22Чаплинкский':580, '23Cтароконстантиновский':581, '23Белогорский':582, '23Веньковецкий':583, '23Волочисский':584, '23г. Каменец-Подольский':585, '23Городокский':586, '23Деражнянский':587, '23Дунаевецкий':588, '23Изяславский':589, '23Каменец-Подольский':590, '23Красиловский':591, '23Летичевский':592, '23Нетишин':593, '23Новоушицкий':594, '23Полонский':595, '23Славута':596, '23Славутский':597, '23Староконстантинов':598, '23Староконстантиновский':691, '23Старосинявский':599, '23Теофипольский':600, '23Хмельницкий':601, '23Чемеровецкий':602, '23Шепетовка':603, '23Шепетовский':604, '23Ярмолинецкий':605, '24Ватутино':606, '24Городищенский':607, '24Драбовский':608, '24Жашковский':609, '24Звенигородский':610, '24Золотоноша':611, '24Золотоношский':612, '24Каменский':613, '24Канев':614, '24Каневский':615, '24Катеринопольский':616, '24Корсунь-Шевченковский':617, '24Лысянский':618, '24Маньковский':619, '24Монастырищенский':620, '24Смела':621, '24Смелянский':622, '24Тальновский':623, '24Умань':624, '24Уманьский':625, '24Христиновский':626, '24Черкасский':627, '24Черкассы':628, '24Чернобаевский':629, '24Чигиринский':630, '24Шполянский':631, '25Бахмачский':632, '25Бобровицкий':633, '25Борзнянский':634, '25Варвинский':635, '25Городнянский':636, '25Ичнянский':637, '25Козелецкий':638, '25Коропский':639, '25Корюковский':640, '25Куликовский':641, '25Менский':642, '25Нежин':643, '25Нежинский':644, '25Новгород-Северский':645, '25Носовский':646, '25Прилуки':647, '25Прилукский':648, '25Репкинский':649, '25Семеновский':650, '25Славутич':651, '25Сосницкий':652, '25Сребнянский':653, '25Талалаевский':654, '25Чернигов':655, '25Черниговский':656, '25Щорский':657, '26Вижницкий':658, '26Герцаевский':659, '26Глыбокский':660, '26Заставновский':661, '26Кельменецкий':662, '26Кицманский':663, '26Новоднестровск':664, '26Новоселицкий':665, '26Путильский':666, '26Сокирянский':667, '26Сторожинецкий':668, '26Хотинский':669, '26Черновцы':670}
    %}
    <listing id="{{ item.pk }}" type="{{ property_types.get(item.property_type, '1') }}" state="active">
        <transactionTypeId>{{ deal_types.get(item.deal_type, 0) }}</transactionTypeId>
        <countryId>1</countryId>
        {% with regionId = regions.get(province) %}
        {% with districtId = districts.get(regionId|string + locality) %}
            {% if not districtId %}{% set districtId = districts.get(regionId|string + area) %}{% endif %}
            {%- if locality == 'Киев' %}{% set regionId = 1 %}{% endif -%}
            {%- if locality == 'Севастополь' %}{% set regionId = 27 %}{% endif -%}
            {%- if regionId  -%}
                <regionId>{{ regionId }}</regionId>
                {%- if districtId -%}
                    <districtId>{{ districtId }}</districtId>
                {%- endif -%}
            {%- endif -%}
        {%- endwith -%}{%- endwith -%}
        <street>{{ item.addr_street }}</street>
        {%- if item.addr_house %}<buildingNumber>{{ item.addr_house }}</buildingNumber>{% endif %}
        <roomCount>{{ item.rooms|default('1') }}</roomCount>
        <floor>{{ item.floor|default('1') }}</floor>
        <floorCount>{{ item.floors_total|default('1') }}</floorCount>
        <areaGeneral>{{ item.area }}</areaGeneral>
        {%- if item.area_living %}<areaLiving>{{ item.area_living }}</areaLiving>{% endif %}
        {%- if item.area_kitchen %}<areaKitchen>{{ item.area_kitchen }}</areaKitchen>{% endif %}
        <marketSegmentId>2</marketSegmentId>
        <addInfo>ID объекта в базе {{ item.pk }}.{{ '\n' }}{{item.description|remove_control_chars() or '' }}{{ '\n' }}Работает call back телефония - мы вам перезвоним.</addInfo>
        {% if item.cleaned_photos -%}
            <photos>
                {%- for photo in item.cleaned_photos -%}
                    <photo>{{ photo.smart_thumbnail("full") }}</photo>
                {%- endfor -%}
            </photos>
        {%- endif %}
        <price>{{ item.price }}</price>
        <priceTypeId>1</priceTypeId>
        <currencyId>{{ currencies[item.currency] }}</currencyId>
        <contactPhone>{{ item.phones.all()|join(" ")|replace("380443613605", "380443600922") }}</contactPhone>
        <contactName>Bank.Mesto.UA</contactName>
        <contactEmail>{{ email }}</contactEmail>
        <userUrl>{{ item.get_bank_url() }}</userUrl>
    </listing>{% endwith %}{% endfor %}
</listings>
</import>



