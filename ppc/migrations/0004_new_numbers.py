# -*- coding: utf-8 -*-
# Generated by Django 1.9.10 on 2017-01-12 04:06
from __future__ import unicode_literals

from django.db import migrations

numbers = ['380673256904', '380673256905', '380673256906', '380673259517', '380673262735', '380673262736', '380673262737', '380673262738',
         '380673262739', '380673262740', '380673262741', '380673262742', '380673262743', '380673262744', '380673262745', '380673262746',
         '380673262747', '380673262748', '380673262749', '380673262750', '380673262751', '380673262752', '380673262753', '380673262754',
         '380673262755', '380673262756', '380673262757', '380673262758', '380673262759', '380673262760', '380673262761', '380673262762',
         '380673262763', '380673262764', '380673262765', '380673262766', '380673262767', '380673262768', '380673262769', '380673262770',
         '380673262771', '380673262773', '380673262774', '380673262775', '380673262776', '380673262778', '380673262779', '380673262780',
         '380673262781', '380673262782', '380673262783', '380673262784', '380673262785', '380673262786', '380673262787', '380673262788',
         '380673262789', '380673262790', '380673262791', '380673262792', '380673262793', '380673262794', '380673262795', '380673262796',
         '380673262797', '380673262798', '380673262799', '380673262800', '380673262801', '380673262802', '380673262803', '380673262804',
         '380673262805', '380673262806', '380673262807', '380673262808', '380673262809', '380673262810', '380673262811', '380673262812',
         '380673262813', '380673262814', '380673262815', '380673262816', '380673262817', '380673262818', '380673262819', '380673262821',
         '380673262822', '380673262823', '380673262824', '380673262825', '380673262826', '380673262830', '380673262831', '380673262832',
         '380673262833', '380673262834', '380673262835', '380673262836']

shared_numbers = ['380673262800', '380673262801', '380673262802', '380673262803', '380673262804', '380673262805', '380673262806', '380673262807', '380673262808', '380673262809',]
shared_numbers_for_newhomes = ['380673262799']


def forwards_func(apps, schema_editor):
    ProxyNumber = apps.get_model("ppc", "ProxyNumber")

    for number in numbers:
        ProxyNumber.objects.get_or_create(number=number, provider="ringostat")

    # сбрасываем старые общие номера
    ProxyNumber.objects.filter(provider="ringostat", is_shared=True).update(is_shared=False, deal_type=None)

    # назначаем новые общие номера
    ProxyNumber.objects.filter(provider="ringostat", number__in=shared_numbers).update(is_shared=True, deal_type=None)
    ProxyNumber.objects.filter(provider="ringostat", number__in=shared_numbers_for_newhomes).update(is_shared=True, deal_type='newhomes')


def reverse_func(apps, schema_editor):
    pass


class Migration(migrations.Migration):

    dependencies = [
        ('ppc', '0003_switch_to_ringostat'),
    ]

    operations = [
        migrations.RunPython(forwards_func, reverse_func),
    ]
